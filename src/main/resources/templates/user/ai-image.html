<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>AI Image Generator - DevCollab</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f8fafc; padding: 3rem; font-family: "Segoe UI", sans-serif; }
        .preview { margin-top: 2rem; text-align: center; }
        img { border-radius: 12px; box-shadow: 0 0 15px rgba(0,0,0,0.15); max-width: 512px; }
    </style>
</head>
<body>
<div class="container">
    <h2 class="mb-4 fw-bold">üß† AI Project Image Generator</h2>

    <div class="mb-3">
        <label class="form-label">Describe your image idea:</label>
        <textarea id="prompt" class="form-control" rows="3"
                  placeholder="e.g., a futuristic dashboard for DevCollab with kanban cards and team avatars"></textarea>
    </div>

    <button class="btn btn-primary" onclick="generateImage()">Generate Image</button>

    <div id="loading" class="mt-3 text-muted" style="display:none;">‚è≥ Generating...</div>
    <div class="preview" id="preview"></div>
</div>

<script>
    async function generateImage() {
        const prompt = document.getElementById("prompt").value.trim();
        if (!prompt) return alert("Please enter a prompt.");

        document.getElementById("loading").style.display = "block";
        document.getElementById("preview").innerHTML = "";

        const res = await fetch("/api/ai/image", {
            method: "POST",
            headers: { "Content-Type": "text/plain" },
            body: prompt
        });

        const data = await res.text();
        document.getElementById("loading").style.display = "none";

        if (data.startsWith("‚ö†Ô∏è")) {
            document.getElementById("preview").innerHTML =
                `<p class='text-danger'>${data}</p>`;
        } else {
            document.getElementById("preview").innerHTML =
                `<img src="${data}" alt="Generated image" class="img-fluid">`;
        }
    }
</script>
</body>
</html>
